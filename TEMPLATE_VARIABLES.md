# 템플릿 변수 목록

ADeX 효과 분석 보고서 템플릿에서 사용하는 모든 변수와 데이터 구조를 정리한 문서입니다. 페이지 구조 및 Figma 어노테이션과 동기화하여 관리합니다.

## 목차
1. [전역/공용 변수](#전역공용-변수)
2. [페이지별 변수](#페이지별-변수)
   1. [페이지 1 – 표지](#페이지-1--표지)
   2. [페이지 2 – 목차](#페이지-2--목차)
   3. [페이지 4 – 미디어그룹 상품 정보](#페이지-4--미디어그룹-상품-정보)
   4. [페이지 5 – 주요 광고 성과 Ⅰ](#페이지-5--주요-광고-성과--ⅰ)
   5. [페이지 6 – 주요 광고 성과 Ⅱ](#페이지-6--주요-광고-성과--ⅱ)
   6. [페이지 7 – 주요 광고 성과 Ⅲ](#페이지-7--주요-광고-성과--ⅲ)
   7. [페이지 12 – 분기 페이지](#페이지-12--분기-페이지)
   8. [페이지 13~16 – 미디어그룹 상세](#페이지-1316--미디어그룹-상세)
3. [반복 데이터 및 객체](#반복-데이터-및-객체)
4. [차트 데이터 구조](#차트-데이터-구조)
5. [지도 및 이미지 자원](#지도-및-이미지-자원)
6. [조건부 렌더링 및 포맷 가이드](#조건부-렌더링-및-포맷-가이드)
7. [변경 이력](#변경-이력)

---

## 전역/공용 변수

| 변수명 | 타입 | 설명 | 사용 위치 |
|--------|------|------|-----------|
| `{{카카오맵API키}}` | String | Kakao 지도 SDK 호출용 앱 키 | `<body>` data attr |
| `{{광고계약명}}` | String | 광고 계약명 | 페이지 1, 2, 4~11, 13~16 |
| `{{광고주명}}` | String | 광고주명 | 페이지 1, 4 |
| `{{광고시작일}}` | String | 광고 시작일 (`YYYY-MM-DD`) | 페이지 1, 4~11, 13~16 |
| `{{광고종료일}}` | String | 광고 종료일 (`YYYY-MM-DD`) | 페이지 1, 4~11, 13~16 |
| `{{운영일수}}` | Number | 광고 운영 일수 (일) | 페이지 1, 4, 13 |
| `{{보고서발행일}}` | String | 보고서 발행일 | 페이지 1, 4 |

---

## 페이지별 변수

### 페이지 1 – 표지
| 변수명 | 타입 | 설명 |
|--------|------|------|
| `{{광고계약명}}` | String | 메인 표지 타이틀 |
| `{{광고주명}}` | String | 광고주 표시 |
| `{{광고시작일}}`, `{{광고종료일}}` | String | 광고 기간 |
| `{{운영일수}}` | Number | 광고 기간 일수 |
| `{{보고서발행일}}` | String | 발행일(하단 텍스트) |

### 페이지 2 – 목차
| 변수명 | 타입 | 설명 |
|--------|------|------|
| `{{광고계약명}}` | String | 상단 브레드크럼 |
| `{{미디어그룹명1}}`, `{{미디어그룹명2}}`, `{{미디어그룹명3}}` | String | 목차용 대표 미디어그룹 |
| `{{미디어그룹리스트}}` | String / HTML | 목차 내 미디어그룹 목록 (템플릿 엔진으로 반복 생성 권장) |

### 페이지 4 – 미디어그룹 상품 정보
| 변수명 | 타입 | 설명 |
|--------|------|------|
| `{{미디어그룹상품_1}}`, `{{미디어그룹상품_2}}`, `{{미디어그룹상품_3}}` | String | 상품명 1~3 |
| `{{미디어정보_1}}`, `{{미디어정보_2}}`, `{{미디어정보_3}}` | String | 미디어 정보 (유형/사이즈/간격/대수) |
| `{{광고주명}}` | String | 광고주 (테이블 상단) |
| `{{광고계약명}}` | String | 계약명 (테이블 상단) |
| `{{광고시작일}}`, `{{광고종료일}}`, `{{운영일수}}` | String/Number | 광고 기간 정보 |
| `{{보고서발행일}}` | String | 발행일 |

### 페이지 5 – 주요 광고 성과 Ⅰ
| 변수명 | 타입 | 설명 |
|--------|------|------|
| `{{circulation}}` | Number | 유동인구 총합 |
| `{{ots}}` | Number | 노출인구 총합 |
| `{{노출비율}}` | Number | 유동 대비 노출 비율 (%) |
| `{{광고효과수준}}` | String | Figma 인사이트 문구에 사용되는 효과 수준 |
| `{{주요오디언스}}` | String | 메인 오디언스 (예: “20대 남성”) |
| `{{광고시작일}}`, `{{광고종료일}}` | String | 데이터 수집 기간 표시 |

### 페이지 6 – 주요 광고 성과 Ⅱ
| 변수명 | 타입 | 설명 |
|--------|------|------|
| `{{최다미디어그룹}}` | String | 노출인구 최다 미디어그룹 |
| `{{최다ots수}}` | Number | 최다 미디어그룹의 노출인구 수 |
| `{{오디언스1위}}`, `{{오디언스2위}}`, `{{오디언스3위}}` | String | 상위 오디언스 명 |
| `{{오디언스1위비율}}`, `{{오디언스2위비율}}`, `{{오디언스3위비율}}` | Number | 상위 오디언스 비율 (%) |
| `{{주요오디언스}}` | String | 인사이트 박스용 주요 오디언스 |

### 페이지 7 – 주요 광고 성과 Ⅲ
| 변수명 | 타입 | 설명 |
|--------|------|------|
| `{{미디어그룹리스트}}` | Array | 성과 테이블용 데이터 배열 (상세 구조는 [반복 데이터 및 객체](#반복-데이터-및-객체) 참고) |
| `{{CPM}}` | Number | 기본 CPM (테이블 마지막 행에서 단일 값 사용 시) |
| `{{광고비}}` | Number | CPM 문구에 사용되는 기준 광고비 (만원 단위) |
| `{{circulation}}`, `{{ots}}`, `{{circulation대비ots비율}}` | Number | 각 필드 값 (단일 행 사용 시) |
| `{{유사미디어그룹명}}` | String | 유사 미디어그룹 안내 문구 |
| `{{주요오디언스}}` | String | 유사 미디어그룹 안내 문구 (괄호 표기) |
| `{{주요오디언스유사미디어그룹명}}` | String | 유사 미디어그룹명 (표 상단 헤더) |
| `{{주요오디언스유사미디어그룹circulation}}`, `{{…ots}}`, `{{…circulation대비ots비율}}`, `{{…CPM}}` | Number | 유사 미디어그룹 데이터 (스네이크형 이름은 하단 추가 표 참고) |

### 페이지 12 – 분기 페이지
| 변수명 | 타입 | 설명 |
|--------|------|------|
| `{{미디어그룹명_a}}`, `{{미디어그룹명_b}}`, `{{미디어그룹명_c}}` | String | 분석 미디어그룹 리스트 (a/b/c) |

### 페이지 13~16 – 미디어그룹 상세
| 변수명 | 타입 | 설명 | 페이지 |
|--------|------|------|--------|
| `{{미디어그룹명}}` | String | 상세 섹션 타이틀 | 13~16 |
| `{{광고물유형}}` | String | 서브타이틀 정보 | 13 |
| `{{장소적 특징}}` | String | 위치/특징 설명 | 13 |
| `{{미디어위치}}` | String | 광고 위치 | 13 |
| `{{미디어대수}}` | Number | 미디어 대수 총합 | 13 |
| `{{미디어유형/사이즈/간격/대수}}` | String | 상세 규격 (슬래시 포함 문자열) | 13 |
| `{{운영시간}}` | String | 운영 시간 | 13 |
| `{{콘텐츠정보}}` | String | 콘텐츠 설명 | 13 |
| `{{광고운영방식}}` | String | 운영 방식 | 13 |
| `{{운영현장이미지1}}`, `{{운영현장이미지2}}` | URL | 현장 이미지 | 13 |
| `{{주요오디언스}}`, `{{주요오디언스비율}}` | String/Number | 주요 오디언스 정보 | 14 |
| `{{일반송출횟수}}`, `{{싱크송출횟수}}` | Number | 송출 횟수 | 14 |
| `{{일평균송출횟수}}`, `{{일최소송출보장수}}` | Number | 일 평균/보장 횟수 | 14 |
| `{{송출보장달성률}}`, `{{평균송출주기}}` | Number | 달성률(%), 주기(초) | 14 |
| `{{타임광고운영여부}}` | Boolean | 타임 광고 섹션 표시 여부 | 14 |
| `{{총노출시간}}`, `{{총노출보장시간}}` | Number | 타임 광고 노출/보장 시간(시간) | 14 |
| `{{타임송출보장달성률}}` | Number | 타임 광고 달성률 (%) | 14 |
| `{{주요요일}}`, `{{주요시간대}}` | String | 송출 집중 요일/시간대 | 14 |
| `{{최다연령성별}}` | String | 노출 최다 연령·성별 | 15 |
| `{{최다날짜}}` | String | 노출 최고 일자 | 15 |
| `{{최다요일}}` | String | 노출 최고 요일 | 16 |
| `{{최다시간대}}` | String | 노출 최고 시간대 | 16 |

---

## 반복 데이터 및 객체

### 1. `미디어정보리스트` (페이지 4 예시 반복)
```javascript
{
  유형: "LCD" | "LED" | "기타",
  사이즈: Number,       // LCD 시 인치
  세로: Number,         // LED/기타 시 mm
  가로: Number,         // LED/기타 시 mm
  간격: Number,         // LED 전용, mm
  대수: Number
}
```

### 2. `미디어그룹리스트` (페이지 5, 7 등)
```javascript
{
  이름: String,
  circulation: Number,              // 유동인구
  ots: Number,                      // 노출인구
  circulation대비ots비율: Number,   // %
  CPM: Number,                      // 원 단위
  유사미디어그룹: Boolean          // 테이블 강조 여부
}
```

### 3. `주요오디언스유사미디어그룹` 객체 (조건부)
```javascript
{
  이름: String,
  circulation: Number,
  ots: Number,
  circulation대비ots비율: Number, // %
  CPM: Number                     // 원 단위
}
```
> 템플릿에는 단일 값 변수(`{{주요오디언스유사미디어그룹circulation}}` 등)와 객체 접근(`{{주요오디언스유사미디어그룹.circulation}}`) 두 형태가 공존합니다. 사용하는 템플릿 엔진에 맞춰 한 가지 방식으로 통일해 주십시오.

---

## 차트 데이터 구조

아래 구조는 Chart.js 스크립트에서 요구하는 형식입니다. 서버 사이드에서 동일한 키를 가진 JSON을 주입해 주세요.

1. **페이지 5 – 미디어그룹별 유동/노출인구**
```javascript
const 미디어그룹별유동노출인구데이터 = {
  미디어그룹리스트: [
    {
      미디어그룹명: String,
      유동인구: Number,
      노출인구: Number,
      색상: String,           // HEX
      유사미디어그룹: Boolean // true 시 연한 색상 처리
    }
  ]
};
```

2. **페이지 6 – 미디어그룹별 유동/노출 인사이트 (스크립트 내 임시 상수)**  
`미디어그룹별circulationots데이터`가 동일한 구조를 사용합니다. 필요 시 동일 Shape 로 주입하면 됩니다.

3. **페이지 9 – 일별 노출인구**
```javascript
const 일별노출인구데이터 = {
  날짜리스트: [String],  // "MM.DD" 혹은 "YYYY-MM-DD"
  미디어그룹리스트: [
    {
      미디어그룹명: String,
      일별데이터: [Number],
      색상: String // HEX
    }
  ],
  일평균: Number? // 선택: 평균선 표시용
};
```

4. **페이지 10 – 요일별 노출인구**
```javascript
const 요일별노출인구데이터 = {
  요일리스트: ["월","화","수","목","금","토","일"],
  미디어그룹리스트: [
    {
      미디어그룹명: String,
      요일별데이터: [Number],
      색상: String
    }
  ],
  일평균: Number // 라인 차트용
};
```

5. **페이지 11 – 시간대별 노출인구**
```javascript
const 시간대별노출인구데이터 = {
  시간대리스트: ["09시", …, "22시"],
  미디어그룹리스트: [
    {
      미디어그룹명: String,
      시간대별데이터: [Number],
      색상: String
    }
  ],
  시간대평균: Number // 평균선 표시용
};
```

6. **페이지 15 – 연령·성별 분포**
```javascript
const 연령성별분포데이터 = {
  연령대리스트: [String],
  성별리스트: ["남성", "여성"],
  데이터: [
    { 연령대: String, 성별: "남성"|"여성", 노출인구: Number }
  ]
};
```

7. **페이지 15 – 일별 노출인구 (상세)**
```javascript
const 상세일별노출인구데이터 = {
  날짜리스트: [String],
  일별데이터: [Number] // 단일 미디어그룹 기준
};
```

8. **페이지 16 – 요일/시간대 비교 (상세)**
동일하게 `요일별노출인구데이터`, `시간대별노출인구데이터` 재사용. 평균값을 반드시 제공하여 인사이트 라벨이 정확히 표시되도록 합니다.

---

## 지도 및 이미지 자원

| 변수명 | 타입 | 설명 | 비고 |
|--------|------|------|------|
| `{{위도}}`, `{{경도}}` | Number | Kakao Map 중심 좌표 | 페이지 13 |
| `{{미디어그룹번호}}` | Number/String | 맵 DOM ID 구분자 (`map-{{미디어그룹번호}}`) | 페이지 13 |
| `{{운영현장이미지1}}`, `{{운영현장이미지2}}` | URL/String | 현장 이미지 경로 | JPEG/PNG 권장 |

Kakao 지도를 사용하지 않고 정적 이미지를 사용하려면, 지도 컨테이너에 직접 `<img>`를 대체 삽입하고 좌표 변수를 생략해도 됩니다.

---

## 조건부 렌더링 및 포맷 가이드

1. **타임 광고 분석(페이지 14)**  
   - `{{타임광고운영여부}}`가 `false`/`0`/`""`이면 `.frame-time-ad-delivery-analysis` 컨테이너를 렌더링하지 마세요.

2. **유사 미디어그룹 블록(페이지 7)**  
   - `{{주요오디언스유사미디어그룹}}` 객체 또는 파생 변수(`{{주요오디언스유사미디어그룹명}}` 등)가 비어 있으면 관련 행을 숨깁니다.

3. **데이터 포맷**
   - 날짜: `YYYY-MM-DD` 형식 유지 (스크립트에서 `MM.DD`로 변환 가능).
   - 숫자: 천 단위 구분 없이 원시 값으로 전달 (Chart.js 및 템플릿에서 포맷 처리).
   - 비율/퍼센트: 정수 기준(예: `85` → 85%). 소수점이 필요한 경우 반올림 처리 후 전달.
   - 색상: HEX (`#00C5A3`) 또는 rgba 문자열.

4. **차트와 텍스트 동기화**
   - 인사이트 문구(예: `{{최다날짜}}`, `{{최다요일}}`, `{{최다시간대}}`)는 차트 데이터와 동일한 기준으로 계산해 주어야 합니다.
   - CPM 문구는 `{{광고비}}`(만원)와 `{{CPM}}`(원)을 동시에 제공해야 일관된 표기가 가능합니다.

5. **템플릿 엔진 주의**
   - 예제 코드에는 Handlebars/Jinja 표현식이 포함되어 있습니다. 사용하는 엔진에 따라 `{{#each}}`, `{% for %}` 등 문법을 선택적으로 반영하세요.
   - 객체 접근 방식(`object.key`)과 미리 계산된 평탄화 변수(`objectkey`)가 혼용되어 있으므로 프로젝트 규칙에 맞춰 한 가지 방식으로 정리해서 사용하는 것을 권장합니다.

---

## 변경 이력

- 2025-01-XX : 페이지별/데이터 구조 재정리, Figma 어노테이션 기반 최신 변수 반영
- 2025-01-XX : 초기 문서 작성


